"use strict";var _interopRequireDefault=require("@babel/runtime-corejs3/helpers/interopRequireDefault");var _Object$defineProperty=require("@babel/runtime-corejs3/core-js-stable/object/define-property");_Object$defineProperty(exports,"__esModule",{value:true});exports.default=getPermissionProps;var _includes=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/includes"));function getPermissionProps({type,action,data,types,user,permissions=[]}){const{role:userRole=[]}=user||{};let isAllowed=!permissions.length||(0,_includes.default)(userRole).call(userRole,'admin');let checkSelf;for(const p of permissions){const{role,actions}=typeof p==='string'?{role:p}:p;if(role==='self'){checkSelf=userId=>user&&user.id===userId&&(!actions||(0,_includes.default)(actions).call(actions,action));}if(!(0,_includes.default)(userRole).call(userRole,role))continue;if(!actions||(0,_includes.default)(actions).call(actions,action)){isAllowed=true;break;}}if(isAllowed){checkSelf=false;}else if(checkSelf){isAllowed=true;}return{isAllowed,checkSelf};}module.exports=exports.default;