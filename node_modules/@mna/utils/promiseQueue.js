"use strict";var _interopRequireDefault=require("@babel/runtime-corejs3/helpers/interopRequireDefault");var _Object$defineProperty=require("@babel/runtime-corejs3/core-js-stable/object/define-property");require("core-js/modules/es.array.iterator");require("core-js/modules/es.promise");require("core-js/modules/web.dom-collections.iterator");_Object$defineProperty(exports,"__esModule",{value:true});exports.default=promiseQueue;var _regenerator=_interopRequireDefault(require("@babel/runtime-corejs3/regenerator"));var _splice=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/splice"));var _promise=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/promise"));var _map=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/map"));require("regenerator-runtime/runtime");var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime-corejs3/helpers/asyncToGenerator"));function promiseQueue(_x){return _promiseQueue.apply(this,arguments);}function _promiseQueue(){_promiseQueue=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee(promiseCreators,limit=1){var results,queue,i,len,isLastItemInBatch,isLastItem,promises,promiseResults;return _regenerator.default.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:results=[];queue=[];i=0,len=promiseCreators.length;case 3:if(!(i<len)){_context.next=18;break;}queue.push(promiseCreators[i]);isLastItemInBatch=(i+1)%limit===0;isLastItem=i===len-1;if(!(!isLastItemInBatch&&!isLastItem)){_context.next=9;break;}return _context.abrupt("continue",15);case 9:promises=(0,_map.default)(queue).call(queue,fn=>fn());_context.next=12;return _promise.default.all(promises);case 12:promiseResults=_context.sent;results.push(...promiseResults);(0,_splice.default)(queue).call(queue,0);case 15:i++;_context.next=3;break;case 18:return _context.abrupt("return",results);case 19:case"end":return _context.stop();}},_callee);}));return _promiseQueue.apply(this,arguments);}module.exports=exports.default;